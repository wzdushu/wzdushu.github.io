<!doctype html><html lang=en itemscope itemtype=http://schema.org/WebPage data-theme=light><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>kubeadm部署高可用kubernetes集群 - 丸子有记
</title><meta name=renderer content="webkit"><meta name=viewport content="width=device-width,initial-scale=1,user-scalable=yes"><meta name=MobileOptimized content="width"><meta name=HandheldFriendly content="true"><meta name=applicable-device content="pc,mobile"><meta name=color-scheme content="light dark"><meta name=msapplication-navbutton-color content="#f8f5ec"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="#f8f5ec"><meta name=mobile-web-app-capable content="yes"><meta name=author content="wanzi"><meta name=description content="kubeadm部署高可用kubernetes集群"><meta name=keywords content="丸子有记,运维,devops,sre,运维架构,运维开发,go语言,python"><meta name=generator content="Hugo 0.121.0"><link rel=canonical href=/post/kubernetes-kubeadm-haproxy-keepalived-deploy.zh-cn/><link rel=icon href=/favicon.ico><link rel=stylesheet href=/css/style.min.4d9e22c6c4a4cfe9ca1e35f9578ca6c8ff84c408a5f0599c8cbdaf444e95eae8.css integrity="sha256-TZ4ixsSkz+nKHjX5V4ymyP+ExAil8FmcjL2vRE6V6ug=" media=screen crossorigin=anonymous><meta property="og:title" content="kubeadm部署高可用kubernetes集群"><meta property="og:description" content="kubeadm部署高可用kubernetes集群"><meta property="og:type" content="article"><meta property="og:url" content="/post/kubernetes-kubeadm-haproxy-keepalived-deploy.zh-cn/"><meta property="article:section" content="post"><meta property="article:published_time" content="2021-08-15T17:22:42+08:00"><meta property="article:modified_time" content="2021-08-15T17:22:42+08:00"><meta itemprop=name content="kubeadm部署高可用kubernetes集群"><meta itemprop=description content="kubeadm部署高可用kubernetes集群"><meta itemprop=datePublished content="2021-08-15T17:22:42+08:00"><meta itemprop=dateModified content="2021-08-15T17:22:42+08:00"><meta itemprop=wordCount content="3314"><meta itemprop=keywords content="kubeadm,k8s,haproxy,keepalived,"><meta name=twitter:card content="summary"><meta name=twitter:title content="kubeadm部署高可用kubernetes集群"><meta name=twitter:description content="kubeadm部署高可用kubernetes集群"><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script><script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--><script>(function(){var e=localStorage.getItem("theme")||"light";document.documentElement.setAttribute("data-theme",e)})()</script></head><body><div id=back-to-top></div><header><div class=desktop-header><div class=desktop-header-logo><a href=/ class=logo>丸子有记</a></div><nav class=desktop-navbar><ul id=menu class=menu><li class=menu-item><a class=menu-item-link href=/>Home</a></li><li class=menu-item><a class=menu-item-link href=/post/>Archives</a></li><li class=menu-item><a class=menu-item-link href=/tags/>Tags</a></li><li class=menu-item><a class=menu-item-link href=/categories/>Categories</a></li><li class=menu-item><a class=menu-item-link href=/notes/>Notes</a></li><li class=menu-item><a class=menu-item-link href=/about/>About</a></li><li class=menu-item><a id=openSearch class="menu-item-link menu-item-search" href=#></a></li><li class=menu-item><a class="theme-toggle menu-item-link" href=javascript:void(0);></a></li><li class=menu-item><a class=menu-item-link href=/index.xml rel="noopener alternate" type=application/rss+xml title=rss target=_blank></a></li></ul></nav></div><div class=mobile-header><div id=mobile-navbar class=mobile-navbar><div id=mobile-navbar-icon class=mobile-navbar-icon></div><div class=mobile-navbar-logo><a href=/%20/ class=logo>丸子有记</a></div></div><div id=mobile-menu-close-modal class=mobile-menu-close-modal></div><nav id=mobile-menu class=mobile-menu><ul class=mobile-menu-list><li class=mobile-menu-item><a class=menu-item-link href=/>Home</a></li><li class=mobile-menu-item><a class=menu-item-link href=/post/>Archives</a></li><li class=mobile-menu-item><a class=menu-item-link href=/tags/>Tags</a></li><li class=mobile-menu-item><a class=menu-item-link href=/categories/>Categories</a></li><li class=mobile-menu-item><a class=menu-item-link href=/notes/>Notes</a></li><li class=mobile-menu-item><a class=menu-item-link href=/about/>About</a></li><li class=mobile-menu-item><a id=openSearchMobile class="mobile-menu-item-link menu-item-search" href=#></a></li><li class=mobile-menu-item><a class="theme-toggle menu-item-link" href=javascript:void(0);></a></li><li class=mobile-menu-item><a class=menu-item-link href=/index.xml rel="noopener alternate" type=application/rss+xml title=rss target=_blank></a></li></ul></nav></div></header><main id=main class="main pico container"><div class=content-wrapper><aside class=sidebar></aside><div id=content class=content><article class=post><header class=post-header><h1 class=post-title>kubeadm部署高可用kubernetes集群</h1><div class=post-meta-list><div class="post-meta-item post-meta-author"><a href=/about><span class=post-meta-author-name>wanzi</span></a></div><div class="post-meta-item post-meta-time"><time datetime=2021-08-15>2021-08-15</time></div><div class=post-meta__right><span class=post-meta-more>3314 words -
7 min read
- <span class=remark42__counter data-url=/post/kubernetes-kubeadm-haproxy-keepalived-deploy.zh-cn/></span> Comments</span><div class="post-meta-item post-meta-category"><a href=/categories/kubernetes/>kubernetes</a></div><span id=busuanzi_container_page_pv>| 阅读 <span id=busuanzi_value_page_pv></span></span></div></div></header><div class=post-content><p>为了后便后期验证私有化部署
，最近内网环境需要快速搭建一套k8s集群，由于之前对于规模比较大的集群，我一般采用kubeasz和kubespray来搞定，这次对于小环境集群，直接用kubeadm部署会更加高效。</p><p>下面记录kubeadm部署过程：</p><p>集群节点：</p><div class=highlight-container><button class="copy-code-btn outline">Copy</button><div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-4>4</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#40a070>192.168.1.206</span><span style=color:#bbb> </span>sd-cluster-206 node<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#40a070>192.168.1.207</span><span style=color:#bbb> </span>sd-cluster-207 master,etcd<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#40a070>192.168.1.208</span><span style=color:#bbb> </span>sd-cluster-208 master,etcd,haproxy,keepalived<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#40a070>192.168.1.209</span><span style=color:#bbb> </span>sd-cluster-209 master,etcd,haproxy,keepalived</span></span></code></pre></td></tr></table></div></div></div><p>镜像版本：</p><div class=highlight-container><button class="copy-code-btn outline">Copy</button><div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-5>5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-6>6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-7>7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-8>8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-9>9</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>docker pull registry.cn-hangzhou.aliyuncs.com/google_containers/kube-controller-manager:v1.18.3
</span></span><span style=display:flex><span>docker pull registry.cn-hangzhou.aliyuncs.com/google_containers/kube-proxy:v1.18.3
</span></span><span style=display:flex><span>docker pull registry.cn-hangzhou.aliyuncs.com/google_containers/kube-apiserver:v1.18.3
</span></span><span style=display:flex><span>docker pull registry.cn-hangzhou.aliyuncs.com/google_containers/kube-scheduler:v1.18.3
</span></span><span style=display:flex><span>docker pull registry.cn-hangzhou.aliyuncs.com/google_containers/coredns:1.6.5
</span></span><span style=display:flex><span>docker pull registry.cn-hangzhou.aliyuncs.com/google_containers/etcd:3.4.3-0
</span></span><span style=display:flex><span>docker pull registry.cn-hangzhou.aliyuncs.com/google_containers/pause:3.2
</span></span><span style=display:flex><span>docker pull registry.cn-shanghai.aliyuncs.com/gcr-k8s/flannel:v0.14.0
</span></span><span style=display:flex><span>docker pull registry.cn-hangzhou.aliyuncs.com/google_containers/nginx-ingress-controller:v0.48.1</span></span></code></pre></td></tr></table></div></div></div><h2 id=一基本环境设置>一、基本环境设置</h2><h3 id=1安装docker并增加hosts>1、安装docker并增加hosts</h3><div class=highlight-container><button class="copy-code-btn outline">Copy</button><div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-5>5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-6>6</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>yum install -y yum-utils device-mapper-persistent-data lvm2 git
</span></span><span style=display:flex><span>yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo
</span></span><span style=display:flex><span>yum install docker-ce -y
</span></span><span style=display:flex><span>systemctl  start docker
</span></span><span style=display:flex><span>systemctl  <span style=color:#007020>enable</span> docker
</span></span><span style=display:flex><span>systemctl  status docker</span></span></code></pre></td></tr></table></div></div></div><h3 id=2配置hosts>2、配置hosts</h3><div class=highlight-container><button class="copy-code-btn outline">Copy</button><div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-5>5</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>cat  &gt;&gt;  /etc/hosts <span style=color:#4070a0>&lt;&lt; hhhh
</span></span></span><span style=display:flex><span><span style=color:#4070a0>192.168.1.207 sd-cluster-207
</span></span></span><span style=display:flex><span><span style=color:#4070a0>192.168.1.208 sd-cluster-208
</span></span></span><span style=display:flex><span><span style=color:#4070a0>192.168.1.209 sd-cluster-209
</span></span></span><span style=display:flex><span><span style=color:#4070a0>hhhh</span></span></span></code></pre></td></tr></table></div></div></div><h3 id=3禁用防火墙并设置selinux>3、禁用防火墙并设置selinux</h3><div class=highlight-container><button class="copy-code-btn outline">Copy</button><div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-4>4</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>systemctl stop firewalld
</span></span><span style=display:flex><span>systemctl disable firewalld
</span></span><span style=display:flex><span>setenforce <span style=color:#40a070>0</span>
</span></span><span style=display:flex><span>sed -i <span style=color:#4070a0>&#39;s/SELINUX=permissive/SELINUX=disabled/&#39;</span> /etc/sysconfig/selinux</span></span></code></pre></td></tr></table></div></div></div><h3 id=4关闭swap>4、关闭swap</h3><p>Kubernetes 1.8开始要求关闭系统的Swap，如果不关闭，默认配置下kubelet将无法启动。方法一,通过kubelet的启动参数–fail-swap-on=false更改这个限制。方法二,关闭系统的Swap。</p><div class=highlight-container><button class="copy-code-btn outline">Copy</button><div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#60a0b0;font-style:italic># swapoff -a</span></span></span></code></pre></td></tr></table></div></div></div><p>修改/etc/fstab文件，注释掉SWAP的自动挂载，使用free -m确认swap已经关闭。</p><h3 id=5安装所有节点的kubeadm和kubeletipvsadm>5、安装所有节点的kubeadm和kubelet、ipvsadm</h3><p>参考：https://developer.aliyun.com/mirror/kubernetes</p><div class=highlight-container><button class="copy-code-btn outline">Copy</button><div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-11>11</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>cat <span style=color:#4070a0>&lt;&lt;EOF &gt; /etc/yum.repos.d/kubernetes.repo
</span></span></span><span style=display:flex><span><span style=color:#4070a0>[kubernetes]
</span></span></span><span style=display:flex><span><span style=color:#4070a0>name=Kubernetes
</span></span></span><span style=display:flex><span><span style=color:#4070a0>baseurl=https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64/
</span></span></span><span style=display:flex><span><span style=color:#4070a0>enabled=1
</span></span></span><span style=display:flex><span><span style=color:#4070a0>gpgcheck=1
</span></span></span><span style=display:flex><span><span style=color:#4070a0>repo_gpgcheck=1
</span></span></span><span style=display:flex><span><span style=color:#4070a0>gpgkey=https://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg https://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg
</span></span></span><span style=display:flex><span><span style=color:#4070a0>EOF</span>
</span></span><span style=display:flex><span>yum install -y --nogpgcheck  kubelet-1.18.3 kubeadm-1.18.3 ipvsadm 
</span></span><span style=display:flex><span>systemctl <span style=color:#007020>enable</span> kubelet <span style=color:#666>&amp;&amp;</span> systemctl start kubelet</span></span></code></pre></td></tr></table></div></div></div><p>ps: 由于官网未开放同步方式, 可能会有索引gpg检查失败的情况, 这时请用 yum install -y &ndash;nogpgcheck kubelet kubeadm kubectl 安装</p><p>增加ipvsadm，如果重新开机，需要重新加载（可以写在 /etc/rc.local 中开机自动加载）</p><div class=highlight-container><button class="copy-code-btn outline">Copy</button><div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-3>3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-4>4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-5>5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-6>6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-7>7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-8>8</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>cat <span style=color:#4070a0>&lt;&lt;EOF &gt;&gt; /etc/rc.local
</span></span></span><span style=display:flex><span><span style=color:#4070a0>modprobe ip_vs
</span></span></span><span style=display:flex><span><span style=color:#4070a0>modprobe ip_vs_rr
</span></span></span><span style=display:flex><span><span style=color:#4070a0>modprobe ip_vs_wrr
</span></span></span><span style=display:flex><span><span style=color:#4070a0>modprobe ip_vs_sh
</span></span></span><span style=display:flex><span><span style=color:#4070a0>modprobe nf_conntrack_ipv4
</span></span></span><span style=display:flex><span><span style=color:#4070a0>EOF</span>
</span></span><span style=display:flex><span>chmod +x /etc/rc.local</span></span></code></pre></td></tr></table></div></div></div><h2 id=二keepalived配合haproxy实现负载均衡器高可用>二、keepalived配合haproxy实现负载均衡器高可用</h2><div class=highlight-container><button class="copy-code-btn outline">Copy</button><div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>yum -y install keepalived haproxy</span></span></code></pre></td></tr></table></div></div></div><h3 id=1keepalived配置>1、keepalived配置</h3><p>192.168.1.208配置</p><div class=highlight-container><button class="copy-code-btn outline">Copy</button><div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-27>27</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>vrrp_script chk_ha {<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span>script &#34;killall -0 haproxy&#34;  <span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span>interval 2 		<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span>weight -20 					<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>vrrp_instance VI_1 {<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span>state MASTER<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>interface bond0<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span>virtual_router_id 33<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span>mcast_src_ip 192.168.1.208<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span>priority 100 		<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span>nopreempt 			<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span>advert_int 1 				<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span>authentication {<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>		</span>auth_type PASS<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>		</span>auth_pass hak8s<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span>track_script {<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>		</span>chk_ha			## 执行haproxy监测<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span>virtual_ipaddress {<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>		</span><span style=color:#40a070>192.168.1.205</span>/24		##VIP <span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}</span></span></code></pre></td></tr></table></div></div></div><p>192.168.1.209配置</p><div class=highlight-container><button class="copy-code-btn outline">Copy</button><div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-23>23</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>vrrp_script chk_ha {<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span>script &#34;killall -0 haproxy&#34;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span>interval 2<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span>weight -20<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>vrrp_instance VI_1 {<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span>state BACKUP<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span>interface bond0<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span>virtual_router_id 33<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span>mcast_src_ip 192.168.1.209<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span>priority 90<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span>advert_int 1<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span>authentication {<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>		</span>auth_type PASS<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>		</span>auth_pass hak8s<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span>track_script {<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>		</span>chk_ha<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span>virtual_ipaddress {<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>		</span><span style=color:#40a070>192.168.1.205</span>/24<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span>}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>}</span></span></code></pre></td></tr></table></div></div></div><h3 id=2haproxy配置>2、haproxy配置</h3><p>208和209两个master的haproxy配置一样：</p><div class=highlight-container><button class="copy-code-btn outline">Copy</button><div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-27>27</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>global<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>log /dev/log local0<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>maxconn 65535<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>chroot /var/lib/haproxy<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>pidfile /var/run/haproxy.pid<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>stats socket /var/lib/haproxy/stats<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>stats timeout 30s<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>user haproxy<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>group haproxy<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>daemon<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>defaults<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>log global<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>retries 3<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>option redispatch<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>option dontlognull<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>timeout connect 5000<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>timeout client  50000<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>timeout server  50000<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>frontend k8s-apiserver<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>bind *:8443<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>mode tcp<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>balance roundrobin<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>server sd-cluster-04 192.168.1.207:6443 weight 5 check inter 2000 rise 2 fall 3<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>server sd-cluster-05 192.168.1.208:6443 weight 3 check inter 2000 rise 2 fall 3<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>server sd-cluster-06 192.168.1.209:6443 weight 3 check inter 2000 rise 2 fall 3</span></span></code></pre></td></tr></table></div></div></div><p>至此，haproxy高可用已经搭建完成，验证方法，直接关闭208的keepalived服务，看vip是否飘逸到209机器上。</p><h2 id=三kubeadm初始化k8s集群>三、kubeadm初始化k8s集群</h2><h3 id=1初始化第一台master>1、初始化第一台master</h3><p>kubeadm-config.yaml配置</p><div class=highlight-container><button class="copy-code-btn outline">Copy</button><div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-27>27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-28>28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-29>29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-30>30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-31>31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-32><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-32>32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-33><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-33>33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-34><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-34>34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-35><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-35>35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-36><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-36>36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-37><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-37>37</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-38><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-38>38</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-39><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-39>39</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-40><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-40>40</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-41><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-41>41</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-42><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-42>42</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-43><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-43>43</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-44><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-44>44</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-45><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-45>45</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#60a0b0;font-style:italic>#kubeadm-config.yaml</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#062873;font-weight:700>apiVersion</span>:<span style=color:#bbb> </span>kubeadm.k8s.io/v1beta2<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#062873;font-weight:700>bootstrapTokens</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>- <span style=color:#062873;font-weight:700>groups</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span>- system:bootstrappers:kubeadm:default-node-token<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:#062873;font-weight:700>token</span>:<span style=color:#bbb> </span>abcdef.0123456789abcdef<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:#062873;font-weight:700>ttl</span>:<span style=color:#bbb> </span>24h0m0s<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:#062873;font-weight:700>usages</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span>- signing<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span>- authentication<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#062873;font-weight:700>kind</span>:<span style=color:#bbb> </span>InitConfiguration<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#062873;font-weight:700>localAPIEndpoint</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:#062873;font-weight:700>advertiseAddress</span>:<span style=color:#bbb> </span><span style=color:#40a070>192.168.1.208</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:#062873;font-weight:700>bindPort</span>:<span style=color:#bbb> </span><span style=color:#40a070>6443</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#062873;font-weight:700>nodeRegistration</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:#062873;font-weight:700>criSocket</span>:<span style=color:#bbb> </span>/var/run/dockershim.sock<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:#062873;font-weight:700>name</span>:<span style=color:#bbb> </span>sd-cluster-208<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:#062873;font-weight:700>taints</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span>- <span style=color:#062873;font-weight:700>effect</span>:<span style=color:#bbb> </span>NoSchedule<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#062873;font-weight:700>key</span>:<span style=color:#bbb> </span>node-role.kubernetes.io/master<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#0e84b5;font-weight:700>---</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#062873;font-weight:700>apiServer</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:#062873;font-weight:700>timeoutForControlPlane</span>:<span style=color:#bbb> </span>4m0s<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#062873;font-weight:700>apiVersion</span>:<span style=color:#bbb> </span>kubeadm.k8s.io/v1beta2<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#062873;font-weight:700>certificatesDir</span>:<span style=color:#bbb> </span>/etc/kubernetes/pki<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#062873;font-weight:700>clusterName</span>:<span style=color:#bbb> </span>kubernetes<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#062873;font-weight:700>controlPlaneEndpoint</span>:<span style=color:#bbb> </span><span style=color:#4070a0>&#34;192.168.1.208:8443&#34;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#062873;font-weight:700>controllerManager</span>:<span style=color:#bbb> </span>{}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#062873;font-weight:700>dns</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:#062873;font-weight:700>type</span>:<span style=color:#bbb> </span>CoreDNS<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#062873;font-weight:700>etcd</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:#062873;font-weight:700>local</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#062873;font-weight:700>dataDir</span>:<span style=color:#bbb> </span>/var/lib/etcd<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#062873;font-weight:700>imageRepository</span>:<span style=color:#bbb> </span>registry.cn-hangzhou.aliyuncs.com/google_containers<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#062873;font-weight:700>kind</span>:<span style=color:#bbb> </span>ClusterConfiguration<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#062873;font-weight:700>kubernetesVersion</span>:<span style=color:#bbb> </span>v1.18.3<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#062873;font-weight:700>networking</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:#062873;font-weight:700>dnsDomain</span>:<span style=color:#bbb> </span>cluster.local<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:#062873;font-weight:700>podSubnet</span>:<span style=color:#bbb> </span><span style=color:#40a070>10.244.0.0</span>/16<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:#062873;font-weight:700>serviceSubnet</span>:<span style=color:#bbb> </span><span style=color:#40a070>10.96.0.0</span>/16<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#062873;font-weight:700>scheduler</span>:<span style=color:#bbb> </span>{}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#0e84b5;font-weight:700>---</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#062873;font-weight:700>apiVersion</span>:<span style=color:#bbb> </span>kubeproxy.config.k8s.io/v1alpha1<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#062873;font-weight:700>kind</span>:<span style=color:#bbb> </span>KubeProxyConfiguration<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#062873;font-weight:700>mode</span>:<span style=color:#bbb> </span>ipvs</span></span></code></pre></td></tr></table></div></div></div><div class=highlight-container><button class="copy-code-btn outline">Copy</button><div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-27>27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-28>28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-29>29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-30>30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-31>31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-32><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-32>32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-33><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-33>33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-34><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-34>34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-35><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-35>35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-36><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-36>36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-37><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-37>37</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-38><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-38>38</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-39><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-39>39</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-40><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-40>40</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-41><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-41>41</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-42><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-42>42</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-43><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-43>43</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-44><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-44>44</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-45><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-45>45</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-46><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-46>46</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-47><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-47>47</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-48><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-48>48</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-49><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-49>49</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-50><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-50>50</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-51><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-51>51</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-52><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-52>52</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-53><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-53>53</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-54><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-54>54</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-55><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-55>55</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-56><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-56>56</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-57><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-57>57</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-58><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-58>58</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-59><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-59>59</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-60><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-60>60</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-61><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-61>61</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-62><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-62>62</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-63><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-63>63</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-64><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-64>64</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-65><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-65>65</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-66><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-66>66</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-67><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-67>67</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-68><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-68>68</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-69><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-69>69</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-70><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-70>70</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-71><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-71>71</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-72><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-72>72</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-73><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-73>73</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-74><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-74>74</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-75><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-75>75</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-76><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-76>76</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-77><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-77>77</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-78><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-78>78</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-79><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-79>79</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-80><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-80>80</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-81><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-81>81</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-82><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-82>82</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-83><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-83>83</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-84><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-84>84</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-85><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-85>85</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-86><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-86>86</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-87><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-87>87</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-88><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-88>88</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-89><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-89>89</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#60a0b0;font-style:italic># kubeadm init --config kubeadm-config.yaml --upload-certs</span>
</span></span><span style=display:flex><span>W0828 03:02:37.249435   <span style=color:#40a070>17451</span> configset.go:202<span style=color:#666>]</span> WARNING: kubeadm cannot validate component configs <span style=color:#007020;font-weight:700>for</span> API groups <span style=color:#666>[</span>kubelet.config.k8s.io kubeproxy.config.k8s.io<span style=color:#666>]</span>
</span></span><span style=display:flex><span><span style=color:#666>[</span>init<span style=color:#666>]</span> Using Kubernetes version: v1.18.3
</span></span><span style=display:flex><span><span style=color:#666>[</span>preflight<span style=color:#666>]</span> Running pre-flight checks
</span></span><span style=display:flex><span>	<span style=color:#666>[</span>WARNING IsDockerSystemdCheck<span style=color:#666>]</span>: detected <span style=color:#4070a0>&#34;cgroupfs&#34;</span> as the Docker cgroup driver. The recommended driver is <span style=color:#4070a0>&#34;systemd&#34;</span>. Please follow the guide at https://kubernetes.io/docs/setup/cri/
</span></span><span style=display:flex><span><span style=color:#666>[</span>preflight<span style=color:#666>]</span> Pulling images required <span style=color:#007020;font-weight:700>for</span> setting up a Kubernetes cluster
</span></span><span style=display:flex><span><span style=color:#666>[</span>preflight<span style=color:#666>]</span> This might take a minute or two, depending on the speed of your internet connection
</span></span><span style=display:flex><span><span style=color:#666>[</span>preflight<span style=color:#666>]</span> You can also perform this action in beforehand using <span style=color:#4070a0>&#39;kubeadm config images pull&#39;</span>
</span></span><span style=display:flex><span><span style=color:#666>[</span>kubelet-start<span style=color:#666>]</span> Writing kubelet environment file with flags to file <span style=color:#4070a0>&#34;/var/lib/kubelet/kubeadm-flags.env&#34;</span>
</span></span><span style=display:flex><span><span style=color:#666>[</span>kubelet-start<span style=color:#666>]</span> Writing kubelet configuration to file <span style=color:#4070a0>&#34;/var/lib/kubelet/config.yaml&#34;</span>
</span></span><span style=display:flex><span><span style=color:#666>[</span>kubelet-start<span style=color:#666>]</span> Starting the kubelet
</span></span><span style=display:flex><span><span style=color:#666>[</span>certs<span style=color:#666>]</span> Using certificateDir folder <span style=color:#4070a0>&#34;/etc/kubernetes/pki&#34;</span>
</span></span><span style=display:flex><span><span style=color:#666>[</span>certs<span style=color:#666>]</span> Generating <span style=color:#4070a0>&#34;ca&#34;</span> certificate and key
</span></span><span style=display:flex><span><span style=color:#666>[</span>certs<span style=color:#666>]</span> Generating <span style=color:#4070a0>&#34;apiserver&#34;</span> certificate and key
</span></span><span style=display:flex><span><span style=color:#666>[</span>certs<span style=color:#666>]</span> apiserver serving cert is signed <span style=color:#007020;font-weight:700>for</span> DNS names <span style=color:#666>[</span>sd-cluster-208 kubernetes kubernetes.default kubernetes.default.svc kubernetes.default.svc.cluster.local<span style=color:#666>]</span> and IPs <span style=color:#666>[</span>10.96.0.1 192.168.1.208 192.168.1.205<span style=color:#666>]</span>
</span></span><span style=display:flex><span><span style=color:#666>[</span>certs<span style=color:#666>]</span> Generating <span style=color:#4070a0>&#34;apiserver-kubelet-client&#34;</span> certificate and key
</span></span><span style=display:flex><span><span style=color:#666>[</span>certs<span style=color:#666>]</span> Generating <span style=color:#4070a0>&#34;front-proxy-ca&#34;</span> certificate and key
</span></span><span style=display:flex><span><span style=color:#666>[</span>certs<span style=color:#666>]</span> Generating <span style=color:#4070a0>&#34;front-proxy-client&#34;</span> certificate and key
</span></span><span style=display:flex><span><span style=color:#666>[</span>certs<span style=color:#666>]</span> Generating <span style=color:#4070a0>&#34;etcd/ca&#34;</span> certificate and key
</span></span><span style=display:flex><span><span style=color:#666>[</span>certs<span style=color:#666>]</span> Generating <span style=color:#4070a0>&#34;etcd/server&#34;</span> certificate and key
</span></span><span style=display:flex><span><span style=color:#666>[</span>certs<span style=color:#666>]</span> etcd/server serving cert is signed <span style=color:#007020;font-weight:700>for</span> DNS names <span style=color:#666>[</span>sd-cluster-208 localhost<span style=color:#666>]</span> and IPs <span style=color:#666>[</span>192.168.1.208 127.0.0.1 ::1<span style=color:#666>]</span>
</span></span><span style=display:flex><span><span style=color:#666>[</span>certs<span style=color:#666>]</span> Generating <span style=color:#4070a0>&#34;etcd/peer&#34;</span> certificate and key
</span></span><span style=display:flex><span><span style=color:#666>[</span>certs<span style=color:#666>]</span> etcd/peer serving cert is signed <span style=color:#007020;font-weight:700>for</span> DNS names <span style=color:#666>[</span>sd-cluster-208 localhost<span style=color:#666>]</span> and IPs <span style=color:#666>[</span>192.168.1.208 127.0.0.1 ::1<span style=color:#666>]</span>
</span></span><span style=display:flex><span><span style=color:#666>[</span>certs<span style=color:#666>]</span> Generating <span style=color:#4070a0>&#34;etcd/healthcheck-client&#34;</span> certificate and key
</span></span><span style=display:flex><span><span style=color:#666>[</span>certs<span style=color:#666>]</span> Generating <span style=color:#4070a0>&#34;apiserver-etcd-client&#34;</span> certificate and key
</span></span><span style=display:flex><span><span style=color:#666>[</span>certs<span style=color:#666>]</span> Generating <span style=color:#4070a0>&#34;sa&#34;</span> key and public key
</span></span><span style=display:flex><span><span style=color:#666>[</span>kubeconfig<span style=color:#666>]</span> Using kubeconfig folder <span style=color:#4070a0>&#34;/etc/kubernetes&#34;</span>
</span></span><span style=display:flex><span><span style=color:#666>[</span>endpoint<span style=color:#666>]</span> WARNING: port specified in controlPlaneEndpoint overrides bindPort in the controlplane address
</span></span><span style=display:flex><span><span style=color:#666>[</span>kubeconfig<span style=color:#666>]</span> Writing <span style=color:#4070a0>&#34;admin.conf&#34;</span> kubeconfig file
</span></span><span style=display:flex><span><span style=color:#666>[</span>endpoint<span style=color:#666>]</span> WARNING: port specified in controlPlaneEndpoint overrides bindPort in the controlplane address
</span></span><span style=display:flex><span><span style=color:#666>[</span>kubeconfig<span style=color:#666>]</span> Writing <span style=color:#4070a0>&#34;kubelet.conf&#34;</span> kubeconfig file
</span></span><span style=display:flex><span><span style=color:#666>[</span>endpoint<span style=color:#666>]</span> WARNING: port specified in controlPlaneEndpoint overrides bindPort in the controlplane address
</span></span><span style=display:flex><span><span style=color:#666>[</span>kubeconfig<span style=color:#666>]</span> Writing <span style=color:#4070a0>&#34;controller-manager.conf&#34;</span> kubeconfig file
</span></span><span style=display:flex><span><span style=color:#666>[</span>endpoint<span style=color:#666>]</span> WARNING: port specified in controlPlaneEndpoint overrides bindPort in the controlplane address
</span></span><span style=display:flex><span><span style=color:#666>[</span>kubeconfig<span style=color:#666>]</span> Writing <span style=color:#4070a0>&#34;scheduler.conf&#34;</span> kubeconfig file
</span></span><span style=display:flex><span><span style=color:#666>[</span>control-plane<span style=color:#666>]</span> Using manifest folder <span style=color:#4070a0>&#34;/etc/kubernetes/manifests&#34;</span>
</span></span><span style=display:flex><span><span style=color:#666>[</span>control-plane<span style=color:#666>]</span> Creating static Pod manifest <span style=color:#007020;font-weight:700>for</span> <span style=color:#4070a0>&#34;kube-apiserver&#34;</span>
</span></span><span style=display:flex><span><span style=color:#666>[</span>control-plane<span style=color:#666>]</span> Creating static Pod manifest <span style=color:#007020;font-weight:700>for</span> <span style=color:#4070a0>&#34;kube-controller-manager&#34;</span>
</span></span><span style=display:flex><span>W0828 03:02:43.787797   <span style=color:#40a070>17451</span> manifests.go:225<span style=color:#666>]</span> the default kube-apiserver authorization-mode is <span style=color:#4070a0>&#34;Node,RBAC&#34;</span>; using <span style=color:#4070a0>&#34;Node,RBAC&#34;</span>
</span></span><span style=display:flex><span><span style=color:#666>[</span>control-plane<span style=color:#666>]</span> Creating static Pod manifest <span style=color:#007020;font-weight:700>for</span> <span style=color:#4070a0>&#34;kube-scheduler&#34;</span>
</span></span><span style=display:flex><span>W0828 03:02:43.789895   <span style=color:#40a070>17451</span> manifests.go:225<span style=color:#666>]</span> the default kube-apiserver authorization-mode is <span style=color:#4070a0>&#34;Node,RBAC&#34;</span>; using <span style=color:#4070a0>&#34;Node,RBAC&#34;</span>
</span></span><span style=display:flex><span><span style=color:#666>[</span>etcd<span style=color:#666>]</span> Creating static Pod manifest <span style=color:#007020;font-weight:700>for</span> <span style=color:#007020>local</span> etcd in <span style=color:#4070a0>&#34;/etc/kubernetes/manifests&#34;</span>
</span></span><span style=display:flex><span><span style=color:#666>[</span>wait-control-plane<span style=color:#666>]</span> Waiting <span style=color:#007020;font-weight:700>for</span> the kubelet to boot up the control plane as static Pods from directory <span style=color:#4070a0>&#34;/etc/kubernetes/manifests&#34;</span>. This can take up to 4m0s
</span></span><span style=display:flex><span><span style=color:#666>[</span>apiclient<span style=color:#666>]</span> All control plane components are healthy after 23.015352 seconds
</span></span><span style=display:flex><span><span style=color:#666>[</span>upload-config<span style=color:#666>]</span> Storing the configuration used in ConfigMap <span style=color:#4070a0>&#34;kubeadm-config&#34;</span> in the <span style=color:#4070a0>&#34;kube-system&#34;</span> Namespace
</span></span><span style=display:flex><span><span style=color:#666>[</span>kubelet<span style=color:#666>]</span> Creating a ConfigMap <span style=color:#4070a0>&#34;kubelet-config-1.18&#34;</span> in namespace kube-system with the configuration <span style=color:#007020;font-weight:700>for</span> the kubelets in the cluster
</span></span><span style=display:flex><span><span style=color:#666>[</span>upload-certs<span style=color:#666>]</span> Storing the certificates in Secret <span style=color:#4070a0>&#34;kubeadm-certs&#34;</span> in the <span style=color:#4070a0>&#34;kube-system&#34;</span> Namespace
</span></span><span style=display:flex><span><span style=color:#666>[</span>upload-certs<span style=color:#666>]</span> Using certificate key:
</span></span><span style=display:flex><span>0adac55426d376e72f21ec3aee2465f754e78810700843cb75c270be26eaeaf1
</span></span><span style=display:flex><span><span style=color:#666>[</span>mark-control-plane<span style=color:#666>]</span> Marking the node sd-cluster-208 as control-plane by adding the label <span style=color:#4070a0>&#34;node-role.kubernetes.io/master=&#39;&#39;&#34;</span>
</span></span><span style=display:flex><span><span style=color:#666>[</span>mark-control-plane<span style=color:#666>]</span> Marking the node sd-cluster-208 as control-plane by adding the taints <span style=color:#666>[</span>node-role.kubernetes.io/master:NoSchedule<span style=color:#666>]</span>
</span></span><span style=display:flex><span><span style=color:#666>[</span>bootstrap-token<span style=color:#666>]</span> Using token: abcdef.0123456789abcdef
</span></span><span style=display:flex><span><span style=color:#666>[</span>bootstrap-token<span style=color:#666>]</span> Configuring bootstrap tokens, cluster-info ConfigMap, RBAC Roles
</span></span><span style=display:flex><span><span style=color:#666>[</span>bootstrap-token<span style=color:#666>]</span> configured RBAC rules to allow Node Bootstrap tokens to get nodes
</span></span><span style=display:flex><span><span style=color:#666>[</span>bootstrap-token<span style=color:#666>]</span> configured RBAC rules to allow Node Bootstrap tokens to post CSRs in order <span style=color:#007020;font-weight:700>for</span> nodes to get long term certificate credentials
</span></span><span style=display:flex><span><span style=color:#666>[</span>bootstrap-token<span style=color:#666>]</span> configured RBAC rules to allow the csrapprover controller automatically approve CSRs from a Node Bootstrap Token
</span></span><span style=display:flex><span><span style=color:#666>[</span>bootstrap-token<span style=color:#666>]</span> configured RBAC rules to allow certificate rotation <span style=color:#007020;font-weight:700>for</span> all node client certificates in the cluster
</span></span><span style=display:flex><span><span style=color:#666>[</span>bootstrap-token<span style=color:#666>]</span> Creating the <span style=color:#4070a0>&#34;cluster-info&#34;</span> ConfigMap in the <span style=color:#4070a0>&#34;kube-public&#34;</span> namespace
</span></span><span style=display:flex><span><span style=color:#666>[</span>kubelet-finalize<span style=color:#666>]</span> Updating <span style=color:#4070a0>&#34;/etc/kubernetes/kubelet.conf&#34;</span> to point to a rotatable kubelet client certificate and key
</span></span><span style=display:flex><span><span style=color:#666>[</span>addons<span style=color:#666>]</span> Applied essential addon: CoreDNS
</span></span><span style=display:flex><span><span style=color:#666>[</span>endpoint<span style=color:#666>]</span> WARNING: port specified in controlPlaneEndpoint overrides bindPort in the controlplane address
</span></span><span style=display:flex><span><span style=color:#666>[</span>addons<span style=color:#666>]</span> Applied essential addon: kube-proxy
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Your Kubernetes control-plane has initialized successfully!
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>To start using your cluster, you need to run the following as a regular user:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  mkdir -p <span style=color:#bb60d5>$HOME</span>/.kube
</span></span><span style=display:flex><span>  sudo cp -i /etc/kubernetes/admin.conf <span style=color:#bb60d5>$HOME</span>/.kube/config
</span></span><span style=display:flex><span>  sudo chown <span style=color:#007020;font-weight:700>$(</span>id -u<span style=color:#007020;font-weight:700>)</span>:<span style=color:#007020;font-weight:700>$(</span>id -g<span style=color:#007020;font-weight:700>)</span> <span style=color:#bb60d5>$HOME</span>/.kube/config
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>You should now deploy a pod network to the cluster.
</span></span><span style=display:flex><span>Run <span style=color:#4070a0>&#34;kubectl apply -f [podnetwork].yaml&#34;</span> with one of the options listed at:
</span></span><span style=display:flex><span>  https://kubernetes.io/docs/concepts/cluster-administration/addons/
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>You can now join any number of the control-plane node running the following <span style=color:#007020>command</span> on each as root:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  kubeadm join 192.168.1.205:8443 --token abcdef.0123456789abcdef <span style=color:#4070a0;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#4070a0;font-weight:700></span>    --discovery-token-ca-cert-hash sha256:7400f57a033f7527c80a4b015b54b4b6a88ccb2184ab9a6e39b709fb56e10486 <span style=color:#4070a0;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#4070a0;font-weight:700></span>    --control-plane --certificate-key 0adac55426d376e72f21ec3aee2465f754e78810700843cb75c270be26eaeaf1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Please note that the certificate-key gives access to cluster sensitive data, keep it secret!
</span></span><span style=display:flex><span>As a safeguard, uploaded-certs will be deleted in two hours; If necessary, you can use
</span></span><span style=display:flex><span><span style=color:#4070a0>&#34;kubeadm init phase upload-certs --upload-certs&#34;</span> to reload certs afterward.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Then you can join any number of worker nodes by running the following on each as root:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kubeadm join 192.168.1.205:8443 --token abcdef.0123456789abcdef <span style=color:#4070a0;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#4070a0;font-weight:700></span>    --discovery-token-ca-cert-hash sha256:7400f57a033f7527c80a4b015b54b4b6a88ccb2184ab9a6e39b709fb56e10486</span></span></code></pre></td></tr></table></div></div></div><p>配置master节点kubeconfig</p><div class=highlight-container><button class="copy-code-btn outline">Copy</button><div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-2>2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-14-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-14-3>3</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>mkdir -p <span style=color:#bb60d5>$HOME</span>/.kube
</span></span><span style=display:flex><span>cp -i /etc/kubernetes/admin.conf <span style=color:#bb60d5>$HOME</span>/.kube/config
</span></span><span style=display:flex><span>chown <span style=color:#007020;font-weight:700>$(</span>id -u<span style=color:#007020;font-weight:700>)</span>:<span style=color:#007020;font-weight:700>$(</span>id -g<span style=color:#007020;font-weight:700>)</span> <span style=color:#bb60d5>$HOME</span>/.kube/config</span></span></code></pre></td></tr></table></div></div></div><h3 id=2新master节点加入集群>2、新master节点加入集群</h3><div class=highlight-container><button class="copy-code-btn outline">Copy</button><div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-27>27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-28>28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-29>29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-30>30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-31>31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-32><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-32>32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-33><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-33>33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-34><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-34>34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-35><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-35>35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-36><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-36>36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-37><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-37>37</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-38><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-38>38</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-39><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-39>39</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-40><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-40>40</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-41><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-41>41</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-42><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-42>42</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-43><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-43>43</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-44><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-44>44</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-45><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-45>45</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-46><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-46>46</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-47><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-47>47</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-48><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-48>48</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-49><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-49>49</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-50><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-50>50</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-51><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-51>51</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-52><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-52>52</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-53><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-53>53</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-54><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-54>54</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-55><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-55>55</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-56><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-56>56</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-57><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-57>57</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-58><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-58>58</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-59><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-59>59</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-60><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-60>60</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-61><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-61>61</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-62><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-62>62</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-63><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-63>63</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-64><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-64>64</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-65><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-65>65</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-66><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-66>66</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-67><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-67>67</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#60a0b0;font-style:italic># kubeadm join 192.168.1.205:8443 --token abcdef.0123456789abcdef \</span>
</span></span><span style=display:flex><span>&gt;     --discovery-token-ca-cert-hash sha256:7400f57a033f7527c80a4b015b54b4b6a88ccb2184ab9a6e39b709fb56e10486 <span style=color:#4070a0;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#4070a0;font-weight:700></span>&gt;     --control-plane --certificate-key 0adac55426d376e72f21ec3aee2465f754e78810700843cb75c270be26eaeaf1
</span></span><span style=display:flex><span><span style=color:#666>[</span>preflight<span style=color:#666>]</span> Running pre-flight checks
</span></span><span style=display:flex><span>	<span style=color:#666>[</span>WARNING IsDockerSystemdCheck<span style=color:#666>]</span>: detected <span style=color:#4070a0>&#34;cgroupfs&#34;</span> as the Docker cgroup driver. The recommended driver is <span style=color:#4070a0>&#34;systemd&#34;</span>. Please follow the guide at https://kubernetes.io/docs/setup/cri/
</span></span><span style=display:flex><span><span style=color:#666>[</span>preflight<span style=color:#666>]</span> Reading configuration from the cluster...
</span></span><span style=display:flex><span><span style=color:#666>[</span>preflight<span style=color:#666>]</span> FYI: You can look at this config file with <span style=color:#4070a0>&#39;kubectl -n kube-system get cm kubeadm-config -oyaml&#39;</span>
</span></span><span style=display:flex><span><span style=color:#666>[</span>preflight<span style=color:#666>]</span> Running pre-flight checks before initializing the new control plane instance
</span></span><span style=display:flex><span><span style=color:#666>[</span>preflight<span style=color:#666>]</span> Pulling images required <span style=color:#007020;font-weight:700>for</span> setting up a Kubernetes cluster
</span></span><span style=display:flex><span><span style=color:#666>[</span>preflight<span style=color:#666>]</span> This might take a minute or two, depending on the speed of your internet connection
</span></span><span style=display:flex><span><span style=color:#666>[</span>preflight<span style=color:#666>]</span> You can also perform this action in beforehand using <span style=color:#4070a0>&#39;kubeadm config images pull&#39;</span>
</span></span><span style=display:flex><span><span style=color:#666>[</span>download-certs<span style=color:#666>]</span> Downloading the certificates in Secret <span style=color:#4070a0>&#34;kubeadm-certs&#34;</span> in the <span style=color:#4070a0>&#34;kube-system&#34;</span> Namespace
</span></span><span style=display:flex><span><span style=color:#666>[</span>certs<span style=color:#666>]</span> Using certificateDir folder <span style=color:#4070a0>&#34;/etc/kubernetes/pki&#34;</span>
</span></span><span style=display:flex><span><span style=color:#666>[</span>certs<span style=color:#666>]</span> Generating <span style=color:#4070a0>&#34;front-proxy-client&#34;</span> certificate and key
</span></span><span style=display:flex><span><span style=color:#666>[</span>certs<span style=color:#666>]</span> Generating <span style=color:#4070a0>&#34;etcd/peer&#34;</span> certificate and key
</span></span><span style=display:flex><span><span style=color:#666>[</span>certs<span style=color:#666>]</span> etcd/peer serving cert is signed <span style=color:#007020;font-weight:700>for</span> DNS names <span style=color:#666>[</span>sd-cluster-209 localhost<span style=color:#666>]</span> and IPs <span style=color:#666>[</span>192.168.1.209 127.0.0.1 ::1<span style=color:#666>]</span>
</span></span><span style=display:flex><span><span style=color:#666>[</span>certs<span style=color:#666>]</span> Generating <span style=color:#4070a0>&#34;etcd/healthcheck-client&#34;</span> certificate and key
</span></span><span style=display:flex><span><span style=color:#666>[</span>certs<span style=color:#666>]</span> Generating <span style=color:#4070a0>&#34;apiserver-etcd-client&#34;</span> certificate and key
</span></span><span style=display:flex><span><span style=color:#666>[</span>certs<span style=color:#666>]</span> Generating <span style=color:#4070a0>&#34;etcd/server&#34;</span> certificate and key
</span></span><span style=display:flex><span><span style=color:#666>[</span>certs<span style=color:#666>]</span> etcd/server serving cert is signed <span style=color:#007020;font-weight:700>for</span> DNS names <span style=color:#666>[</span>sd-cluster-209 localhost<span style=color:#666>]</span> and IPs <span style=color:#666>[</span>192.168.1.209 127.0.0.1 ::1<span style=color:#666>]</span>
</span></span><span style=display:flex><span><span style=color:#666>[</span>certs<span style=color:#666>]</span> Generating <span style=color:#4070a0>&#34;apiserver&#34;</span> certificate and key
</span></span><span style=display:flex><span><span style=color:#666>[</span>certs<span style=color:#666>]</span> apiserver serving cert is signed <span style=color:#007020;font-weight:700>for</span> DNS names <span style=color:#666>[</span>sd-cluster-209 kubernetes kubernetes.default kubernetes.default.svc kubernetes.default.svc.cluster.local<span style=color:#666>]</span> and IPs <span style=color:#666>[</span>10.96.0.1 192.168.1.209 192.168.1.205<span style=color:#666>]</span>
</span></span><span style=display:flex><span><span style=color:#666>[</span>certs<span style=color:#666>]</span> Generating <span style=color:#4070a0>&#34;apiserver-kubelet-client&#34;</span> certificate and key
</span></span><span style=display:flex><span><span style=color:#666>[</span>certs<span style=color:#666>]</span> Valid certificates and keys now exist in <span style=color:#4070a0>&#34;/etc/kubernetes/pki&#34;</span>
</span></span><span style=display:flex><span><span style=color:#666>[</span>certs<span style=color:#666>]</span> Using the existing <span style=color:#4070a0>&#34;sa&#34;</span> key
</span></span><span style=display:flex><span><span style=color:#666>[</span>kubeconfig<span style=color:#666>]</span> Generating kubeconfig files
</span></span><span style=display:flex><span><span style=color:#666>[</span>kubeconfig<span style=color:#666>]</span> Using kubeconfig folder <span style=color:#4070a0>&#34;/etc/kubernetes&#34;</span>
</span></span><span style=display:flex><span><span style=color:#666>[</span>endpoint<span style=color:#666>]</span> WARNING: port specified in controlPlaneEndpoint overrides bindPort in the controlplane address
</span></span><span style=display:flex><span><span style=color:#666>[</span>kubeconfig<span style=color:#666>]</span> Writing <span style=color:#4070a0>&#34;admin.conf&#34;</span> kubeconfig file
</span></span><span style=display:flex><span><span style=color:#666>[</span>kubeconfig<span style=color:#666>]</span> Writing <span style=color:#4070a0>&#34;controller-manager.conf&#34;</span> kubeconfig file
</span></span><span style=display:flex><span><span style=color:#666>[</span>kubeconfig<span style=color:#666>]</span> Writing <span style=color:#4070a0>&#34;scheduler.conf&#34;</span> kubeconfig file
</span></span><span style=display:flex><span><span style=color:#666>[</span>control-plane<span style=color:#666>]</span> Using manifest folder <span style=color:#4070a0>&#34;/etc/kubernetes/manifests&#34;</span>
</span></span><span style=display:flex><span><span style=color:#666>[</span>control-plane<span style=color:#666>]</span> Creating static Pod manifest <span style=color:#007020;font-weight:700>for</span> <span style=color:#4070a0>&#34;kube-apiserver&#34;</span>
</span></span><span style=display:flex><span>W0828 03:12:57.996811   <span style=color:#40a070>48328</span> manifests.go:225<span style=color:#666>]</span> the default kube-apiserver authorization-mode is <span style=color:#4070a0>&#34;Node,RBAC&#34;</span>; using <span style=color:#4070a0>&#34;Node,RBAC&#34;</span>
</span></span><span style=display:flex><span><span style=color:#666>[</span>control-plane<span style=color:#666>]</span> Creating static Pod manifest <span style=color:#007020;font-weight:700>for</span> <span style=color:#4070a0>&#34;kube-controller-manager&#34;</span>
</span></span><span style=display:flex><span>W0828 03:12:58.009390   <span style=color:#40a070>48328</span> manifests.go:225<span style=color:#666>]</span> the default kube-apiserver authorization-mode is <span style=color:#4070a0>&#34;Node,RBAC&#34;</span>; using <span style=color:#4070a0>&#34;Node,RBAC&#34;</span>
</span></span><span style=display:flex><span><span style=color:#666>[</span>control-plane<span style=color:#666>]</span> Creating static Pod manifest <span style=color:#007020;font-weight:700>for</span> <span style=color:#4070a0>&#34;kube-scheduler&#34;</span>
</span></span><span style=display:flex><span>W0828 03:12:58.011318   <span style=color:#40a070>48328</span> manifests.go:225<span style=color:#666>]</span> the default kube-apiserver authorization-mode is <span style=color:#4070a0>&#34;Node,RBAC&#34;</span>; using <span style=color:#4070a0>&#34;Node,RBAC&#34;</span>
</span></span><span style=display:flex><span><span style=color:#666>[</span>check-etcd<span style=color:#666>]</span> Checking that the etcd cluster is healthy
</span></span><span style=display:flex><span><span style=color:#666>[</span>kubelet-start<span style=color:#666>]</span> Downloading configuration <span style=color:#007020;font-weight:700>for</span> the kubelet from the <span style=color:#4070a0>&#34;kubelet-config-1.18&#34;</span> ConfigMap in the kube-system namespace
</span></span><span style=display:flex><span><span style=color:#666>[</span>kubelet-start<span style=color:#666>]</span> Writing kubelet configuration to file <span style=color:#4070a0>&#34;/var/lib/kubelet/config.yaml&#34;</span>
</span></span><span style=display:flex><span><span style=color:#666>[</span>kubelet-start<span style=color:#666>]</span> Writing kubelet environment file with flags to file <span style=color:#4070a0>&#34;/var/lib/kubelet/kubeadm-flags.env&#34;</span>
</span></span><span style=display:flex><span><span style=color:#666>[</span>kubelet-start<span style=color:#666>]</span> Starting the kubelet
</span></span><span style=display:flex><span><span style=color:#666>[</span>kubelet-start<span style=color:#666>]</span> Waiting <span style=color:#007020;font-weight:700>for</span> the kubelet to perform the TLS Bootstrap...
</span></span><span style=display:flex><span><span style=color:#666>[</span>etcd<span style=color:#666>]</span> Announced new etcd member joining to the existing etcd cluster
</span></span><span style=display:flex><span><span style=color:#666>[</span>etcd<span style=color:#666>]</span> Creating static Pod manifest <span style=color:#007020;font-weight:700>for</span> <span style=color:#4070a0>&#34;etcd&#34;</span>
</span></span><span style=display:flex><span><span style=color:#666>[</span>etcd<span style=color:#666>]</span> Waiting <span style=color:#007020;font-weight:700>for</span> the new etcd member to join the cluster. This can take up to 40s
</span></span><span style=display:flex><span><span style=color:#666>{</span><span style=color:#4070a0>&#34;level&#34;</span>:<span style=color:#4070a0>&#34;warn&#34;</span>,<span style=color:#4070a0>&#34;ts&#34;</span>:<span style=color:#4070a0>&#34;2021-08-28T03:13:15.215-0400&#34;</span>,<span style=color:#4070a0>&#34;caller&#34;</span>:<span style=color:#4070a0>&#34;clientv3/retry_interceptor.go:61&#34;</span>,<span style=color:#4070a0>&#34;msg&#34;</span>:<span style=color:#4070a0>&#34;retrying of unary invoker failed&#34;</span>,<span style=color:#4070a0>&#34;target&#34;</span>:<span style=color:#4070a0>&#34;passthrough:///https://192.168.1.209:2379&#34;</span>,<span style=color:#4070a0>&#34;attempt&#34;</span>:0,<span style=color:#4070a0>&#34;error&#34;</span>:<span style=color:#4070a0>&#34;rpc error: code = DeadlineExceeded desc = context deadline exceeded&#34;</span><span style=color:#666>}</span>
</span></span><span style=display:flex><span><span style=color:#666>[</span>upload-config<span style=color:#666>]</span> Storing the configuration used in ConfigMap <span style=color:#4070a0>&#34;kubeadm-config&#34;</span> in the <span style=color:#4070a0>&#34;kube-system&#34;</span> Namespace
</span></span><span style=display:flex><span><span style=color:#666>[</span>mark-control-plane<span style=color:#666>]</span> Marking the node sd-cluster-209 as control-plane by adding the label <span style=color:#4070a0>&#34;node-role.kubernetes.io/master=&#39;&#39;&#34;</span>
</span></span><span style=display:flex><span><span style=color:#666>[</span>mark-control-plane<span style=color:#666>]</span> Marking the node sd-cluster-209 as control-plane by adding the taints <span style=color:#666>[</span>node-role.kubernetes.io/master:NoSchedule<span style=color:#666>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>This node has joined the cluster and a new control plane instance was created:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>* Certificate signing request was sent to apiserver and approval was received.
</span></span><span style=display:flex><span>* The Kubelet was informed of the new secure connection details.
</span></span><span style=display:flex><span>* Control plane <span style=color:#666>(</span>master<span style=color:#666>)</span> label and taint were applied to the new node.
</span></span><span style=display:flex><span>* The Kubernetes control plane instances scaled up.
</span></span><span style=display:flex><span>* A new etcd member was added to the local/stacked etcd cluster.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>To start administering your cluster from this node, you need to run the following as a regular user:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	mkdir -p <span style=color:#bb60d5>$HOME</span>/.kube
</span></span><span style=display:flex><span>	sudo cp -i /etc/kubernetes/admin.conf <span style=color:#bb60d5>$HOME</span>/.kube/config
</span></span><span style=display:flex><span>	sudo chown <span style=color:#007020;font-weight:700>$(</span>id -u<span style=color:#007020;font-weight:700>)</span>:<span style=color:#007020;font-weight:700>$(</span>id -g<span style=color:#007020;font-weight:700>)</span> <span style=color:#bb60d5>$HOME</span>/.kube/config
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Run <span style=color:#4070a0>&#39;kubectl get nodes&#39;</span> to see this node join the cluster.</span></span></code></pre></td></tr></table></div></div></div><h3 id=3新node节点加入集群>3、新node节点加入集群</h3><div class=highlight-container><button class="copy-code-btn outline">Copy</button><div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-1>1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-16-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-16-2>2</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubeadm join 192.168.1.205:8443 --token abcdef.0123456789abcdef <span style=color:#4070a0;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#4070a0;font-weight:700></span>    --discovery-token-ca-cert-hash sha256:7400f57a033f7527c80a4b015b54b4b6a88ccb2184ab9a6e39b709fb56e10486</span></span></code></pre></td></tr></table></div></div></div><h3 id=4安装flannel网络组件>4、安装flannel网络组件</h3><div class=highlight-container><button class="copy-code-btn outline">Copy</button><div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-13>13</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#60a0b0;font-style:italic># wget http://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml</span>
</span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic># sed -i &#39;s#quay.io/coreos/flannel:v0.14.0#registry.cn-shanghai.aliyuncs.com/gcr-k8s/flannel:v0.14.0#g&#39; kube-flannel.yml</span>
</span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic># kubectl apply -f kube-flannel.yml -n kube-system</span>
</span></span><span style=display:flex><span>podsecuritypolicy.policy/psp.flannel.unprivileged created
</span></span><span style=display:flex><span>clusterrole.rbac.authorization.k8s.io/flannel created
</span></span><span style=display:flex><span>clusterrolebinding.rbac.authorization.k8s.io/flannel created
</span></span><span style=display:flex><span>serviceaccount/flannel created
</span></span><span style=display:flex><span>configmap/kube-flannel-cfg created
</span></span><span style=display:flex><span>daemonset.apps/kube-flannel-ds created
</span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic># kubectl get pod -n kube-system |grep flannel</span>
</span></span><span style=display:flex><span>kube-flannel-ds-gtdl8                    1/1     Running   <span style=color:#40a070>0</span>          24s
</span></span><span style=display:flex><span>kube-flannel-ds-jtndz                    1/1     Running   <span style=color:#40a070>0</span>          24s
</span></span><span style=display:flex><span>kube-flannel-ds-nd79b                    1/1     Running   <span style=color:#40a070>0</span>          24s</span></span></code></pre></td></tr></table></div></div></div><h3 id=5安装ingress>5、安装ingress</h3><div class=highlight-container><button class="copy-code-btn outline">Copy</button><div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-13>13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-14>14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-15>15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-16>16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-17>17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-18>18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-19>19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-20>20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-21>21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-22>22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-23>23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-24>24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-25>25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-26>26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-27>27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-28>28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-29>29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-30>30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-31>31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-32><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-32>32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-33><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-33>33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-34><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-34>34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-35><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-35>35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-36><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-36>36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-37><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-37>37</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-38><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-38>38</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-39><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-39>39</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-40><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-40>40</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-41><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-41>41</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-42><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-42>42</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-43><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-43>43</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-44><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-44>44</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-45><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-45>45</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-46><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-46>46</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-47><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-47>47</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-48><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-48>48</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-49><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-49>49</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-50><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-50>50</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-51><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-51>51</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-52><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-52>52</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-53><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-53>53</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-54><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-54>54</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-55><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-55>55</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-56><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-56>56</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-57><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-57>57</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-58><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-58>58</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-59><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-59>59</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>docker pull registry.cn-hangzhou.aliyuncs.com/google_containers/nginx-ingress-controller:v0.48.1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>wget https://github.com/kubernetes/ingress-nginx/releases/download/helm-chart-3.35.0/ingress-nginx-3.35.0.tgz
</span></span><span style=display:flex><span>tar zxvf helm-chart-3.35.0.tar.gz
</span></span><span style=display:flex><span><span style=color:#007020>cd</span> ingress-nginx
</span></span><span style=display:flex><span>vim values.yaml  <span style=color:#60a0b0;font-style:italic>#更新镜像为上面的国内阿里镜像版本</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#60a0b0;font-style:italic>#helm install ingress-nginx --namespace ingress-nginx  . -n ingress-nginx</span>
</span></span><span style=display:flex><span>NAME: ingress-nginx
</span></span><span style=display:flex><span>LAST DEPLOYED: Tue Aug <span style=color:#40a070>31</span> 17:02:28 <span style=color:#40a070>2021</span>
</span></span><span style=display:flex><span>NAMESPACE: ingress-nginx
</span></span><span style=display:flex><span>STATUS: deployed
</span></span><span style=display:flex><span>REVISION: <span style=color:#40a070>1</span>
</span></span><span style=display:flex><span>TEST SUITE: None
</span></span><span style=display:flex><span>NOTES:
</span></span><span style=display:flex><span>The ingress-nginx controller has been installed.
</span></span><span style=display:flex><span>Get the application URL by running these commands:
</span></span><span style=display:flex><span>  <span style=color:#007020>export</span> <span style=color:#bb60d5>HTTP_NODE_PORT</span><span style=color:#666>=</span><span style=color:#007020;font-weight:700>$(</span>kubectl --namespace ingress-nginx get services -o <span style=color:#bb60d5>jsonpath</span><span style=color:#666>=</span><span style=color:#4070a0>&#34;{.spec.ports[0].nodePort}&#34;</span> ingress-nginx-controller<span style=color:#007020;font-weight:700>)</span>
</span></span><span style=display:flex><span>  <span style=color:#007020>export</span> <span style=color:#bb60d5>HTTPS_NODE_PORT</span><span style=color:#666>=</span><span style=color:#007020;font-weight:700>$(</span>kubectl --namespace ingress-nginx get services -o <span style=color:#bb60d5>jsonpath</span><span style=color:#666>=</span><span style=color:#4070a0>&#34;{.spec.ports[1].nodePort}&#34;</span> ingress-nginx-controller<span style=color:#007020;font-weight:700>)</span>
</span></span><span style=display:flex><span>  <span style=color:#007020>export</span> <span style=color:#bb60d5>NODE_IP</span><span style=color:#666>=</span><span style=color:#007020;font-weight:700>$(</span>kubectl --namespace ingress-nginx get nodes -o <span style=color:#bb60d5>jsonpath</span><span style=color:#666>=</span><span style=color:#4070a0>&#34;{.items[0].status.addresses[1].address}&#34;</span><span style=color:#007020;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#007020>echo</span> <span style=color:#4070a0>&#34;Visit http://</span><span style=color:#bb60d5>$NODE_IP</span><span style=color:#4070a0>:</span><span style=color:#bb60d5>$HTTP_NODE_PORT</span><span style=color:#4070a0> to access your application via HTTP.&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#007020>echo</span> <span style=color:#4070a0>&#34;Visit https://</span><span style=color:#bb60d5>$NODE_IP</span><span style=color:#4070a0>:</span><span style=color:#bb60d5>$HTTPS_NODE_PORT</span><span style=color:#4070a0> to access your application via HTTPS.&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>An example Ingress that makes use of the controller:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  apiVersion: networking.k8s.io/v1beta1
</span></span><span style=display:flex><span>  kind: Ingress
</span></span><span style=display:flex><span>  metadata:
</span></span><span style=display:flex><span>    annotations:
</span></span><span style=display:flex><span>      kubernetes.io/ingress.class: nginx
</span></span><span style=display:flex><span>    name: example
</span></span><span style=display:flex><span>    namespace: foo
</span></span><span style=display:flex><span>  spec:
</span></span><span style=display:flex><span>    rules:
</span></span><span style=display:flex><span>      - host: www.example.com
</span></span><span style=display:flex><span>        http:
</span></span><span style=display:flex><span>          paths:
</span></span><span style=display:flex><span>            - backend:
</span></span><span style=display:flex><span>                serviceName: exampleService
</span></span><span style=display:flex><span>                servicePort: <span style=color:#40a070>80</span>
</span></span><span style=display:flex><span>              path: /
</span></span><span style=display:flex><span>    <span style=color:#60a0b0;font-style:italic># This section is only required if TLS is to be enabled for the Ingress</span>
</span></span><span style=display:flex><span>    tls:
</span></span><span style=display:flex><span>        - hosts:
</span></span><span style=display:flex><span>            - www.example.com
</span></span><span style=display:flex><span>          secretName: example-tls
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>If TLS is enabled <span style=color:#007020;font-weight:700>for</span> the Ingress, a Secret containing the certificate and key must also be provided:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  apiVersion: v1
</span></span><span style=display:flex><span>  kind: Secret
</span></span><span style=display:flex><span>  metadata:
</span></span><span style=display:flex><span>    name: example-tls
</span></span><span style=display:flex><span>    namespace: foo
</span></span><span style=display:flex><span>  data:
</span></span><span style=display:flex><span>    tls.crt: &lt;base64 encoded cert&gt;
</span></span><span style=display:flex><span>    tls.key: &lt;base64 encoded key&gt;
</span></span><span style=display:flex><span>  type: kubernetes.io/tls</span></span></code></pre></td></tr></table></div></div></div><p>对于新建Ingress参考如下设置：</p><div class=highlight-container><button class="copy-code-btn outline">Copy</button><div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-1> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-2> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-3> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-4> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-5> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-6> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-7> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-8> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-9> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-10>10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-11>11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-12>12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-13>13</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>apiVersion: networking.k8s.io/v1
</span></span><span style=display:flex><span>kind: Ingress
</span></span><span style=display:flex><span>metadata:
</span></span><span style=display:flex><span>  name: my-nginx
</span></span><span style=display:flex><span>spec:
</span></span><span style=display:flex><span>  rules:
</span></span><span style=display:flex><span>    - host: <span style=color:#4070a0>&#34;my-nginx.test.com&#34;</span>
</span></span><span style=display:flex><span>      http:
</span></span><span style=display:flex><span>        paths:
</span></span><span style=display:flex><span>          - path: /
</span></span><span style=display:flex><span>            backend:
</span></span><span style=display:flex><span>              serviceName: my-nginx
</span></span><span style=display:flex><span>              servicePort: <span style=color:#40a070>8080</span></span></span></code></pre></td></tr></table></div></div></div><p>至此，kubeadm部署kubernetes高可用集群完成</p></div><div class=post-copyright><p class=copyright-item><span class=item-title>Author</span>
<span class=item-content>wanzi</span></p><p class=copyright-item><span class=item-title>LastMod</span>
<span class=item-content>2021-08-15</span></p><p class=copyright-item><span class=item-title>License</span>
<span class=item-content><a rel="license noopener" href=https://creativecommons.org/licenses/by-nc-nd/4.0/ target=_blank>CC BY-NC-ND 4.0</a></span></p></div><div class=post-reward><input type=checkbox name=reward id=reward hidden>
<label class=reward-button for=reward>Reward</label><div class=qr-code></div></div><footer class=post-footer><div class=post-tags><a href=/tags/kubeadm/>kubeadm</a>
<a href=/tags/k8s/>k8s</a>
<a href=/tags/haproxy/>haproxy</a>
<a href=/tags/keepalived/>keepalived</a></div><nav class=post-nav><a class=prev href=/post/kubernetes-gpushare-aliyun.zh-cn/><i class=iconfont></i><span class="prev-text nav-default">阿里云共享GPU方案测试</span>
<span class="prev-text nav-mobile">Prev</span>
</a><a class=next href=/post/linux-dns-privatezone-bind9-dnsmasq.zh-cn/><span class="next-text nav-default">阿里云PrivateZone+Bind9+Dnsmasq实现内部DNS</span>
<span class="prev-text nav-mobile">Next</span>
<i class=iconfont></i></a></nav></footer></article><div class=comment><script src=https://giscus.app/client.js data-repo=wzdushu/wzdushu.github.io data-repo-id=R_kgDONA8Shg data-category=General data-category-id=DIC_kwDONA8Shs4CjwIH data-mapping=title data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=preferred_color_scheme data-lang=zh-CN data-loading=lazy crossorigin=anonymous async></script></div><div id=remark42></div></div><nav class=toc id=toc><div class=toc-title>Table of Contents</div><div class="toc-content custom-scrollbar"><nav id=TableOfContents><ul><li><a href=#一基本环境设置>一、基本环境设置</a><ul><li><a href=#1安装docker并增加hosts>1、安装docker并增加hosts</a></li><li><a href=#2配置hosts>2、配置hosts</a></li><li><a href=#3禁用防火墙并设置selinux>3、禁用防火墙并设置selinux</a></li><li><a href=#4关闭swap>4、关闭swap</a></li><li><a href=#5安装所有节点的kubeadm和kubeletipvsadm>5、安装所有节点的kubeadm和kubelet、ipvsadm</a></li></ul></li><li><a href=#二keepalived配合haproxy实现负载均衡器高可用>二、keepalived配合haproxy实现负载均衡器高可用</a><ul><li><a href=#1keepalived配置>1、keepalived配置</a></li><li><a href=#2haproxy配置>2、haproxy配置</a></li></ul></li><li><a href=#三kubeadm初始化k8s集群>三、kubeadm初始化k8s集群</a><ul><li><a href=#1初始化第一台master>1、初始化第一台master</a></li><li><a href=#2新master节点加入集群>2、新master节点加入集群</a></li><li><a href=#3新node节点加入集群>3、新node节点加入集群</a></li><li><a href=#4安装flannel网络组件>4、安装flannel网络组件</a></li><li><a href=#5安装ingress>5、安装ingress</a></li></ul></li></ul></nav></div></nav></div></main><footer id=footer class=footer><div class=social-icon-links><a href rel="me noopener" class=social-icon-link title=github target=_blank></a><a href=/index.xml rel="noopener alternate" type=application/rss+xml class=social-icon-link title=rss target=_blank></a></div><div class=copyright><span class=power-by>Powered by <a class=hexo-link href=https://gohugo.io>Hugo</a>
</span><span class=division>|</span>
<span class=theme-info>Theme - <a class=theme-link href=https://github.com/xianmin/hugo-theme-jane>Jane</a>
</span><span class=copyright-year>&copy;
2018 -
2024
<span class=heart><i class=iconfont></i></span><span class=author>丸子有记
</span></span><span id=busuanzi_container>访客数/访问量：<span id=busuanzi_value_site_uv></span>/<span id=busuanzi_value_site_pv></span>
</span><span><a href=https://www.foreverblog.cn/ target=_blank><img src=https://img.foreverblog.cn/logo_en_default.png alt style=width:auto;height:16px> </a>|<a href=https://beian.miit.gov.cn target=_blank>京ICP备2021004162号-1</a></span></div></footer><script type=text/javascript src=/js/main.f4eecbfe30294759805b8c3f5cdd257f04ee0660ed2b189b23ba933aa085253f.js integrity="sha256-9O7L/jApR1mAW4w/XN0lfwTuBmDtKxibI7qTOqCFJT8=" crossorigin=anonymous></script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><script id=baidu_analytics>var _hmt=_hmt||[];(function(){if(window.location.hostname==="localhost")return;var t,e=document.createElement("script");e.async=!0,e.src="https://hm.baidu.com/hm.js?<script> var _hmt = _hmt || [];(function() { var hm = document.createElement("script"); hm.src = "https://hm.baidu.com/hm.js?9f80634ead11eb9ce00a6452d8891ed7"; var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script>",t=document.getElementsByTagName("script")[0],t.parentNode.insertBefore(e,t)})()</script><script type=text/javascript src=/lib/photoswipe/photoswipe.min.js></script><script type=text/javascript src=/lib/photoswipe/photoswipe-ui-default.min.js></script><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><script>var remark_config={host:"https://remark42.example.com",site_id:"remark",components:["embed","counter"]};!function(e,t){for(s=0;s<e.length;s++){var s,n=t.createElement("script"),o=".js",i=t.head||t.body;"noModule"in n?(n.type="module",o=".mjs"):n.async=!0,n.defer=!0,n.src=remark_config.host+"/web/"+e[s]+o,i.appendChild(n)}}(remark_config.components||["embed"],document)</script></body></html>